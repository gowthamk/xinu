#include<xinu.h>
#include<stdio.h>

extern int victimglobal;

extern unsigned long plzhackme_content;

void myhackermalware(int x) {
    victimglobal = 1;
    unsigned long *my_bp, *my_ret;
    kprintf("[Victim %d] HACKED! Inside myhackermalware\n",currpid);
    kprintf("[Victim %d] victimglobal is set to %d\n",currpid, victimglobal);
    asm ("movl %%ebp, %0"
          :"=r"(my_bp)); 
    my_ret = my_bp+1;
    *my_ret = plzhackme_content;
    kprintf("[Victim %d] returning the control back to myvictim()\n",currpid);
    return;
}


